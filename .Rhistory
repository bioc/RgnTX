p1 <- ggplot(data, aes(x)) +
geom_histogram(aes(y = ..density..), alpha = 0.4) +
geom_point(data = data.frame(x = orig.ev, y = 0.01), aes(x=x, y=y),
color = 'red')
p2
p1
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
trans.ids1<- c("170")
RS1 <- randomizeTx(txdb = txdb, trans_ids = trans.ids1,
random_num = 20, random_length = 100)
RS2 <- randomizeTx(txdb = txdb, trans_ids = trans.ids1,
random_num = 20, random_length = 100)
trans.ids2 <-  c("170", "782", "974", "1364", "1387")
RSL <- randomizeTx(txdb = txdb, trans_ids = trans.ids2,
random_num = 20, random_length = 100, N = 50)
zscore <- round((orig.ev - mean(rand.ev, na.rm = TRUE)) / sd(rand.ev,
na.rm = TRUE
), 4)
xcoords <- rand.ev
rand.mean <- mean(xcoords, na.rm = TRUE)
rand.sd <- sd(xcoords, na.rm = TRUE)
ntimes <- length(RSL)
ev_function_1 = overlapCountsTx
ev_function_2 = overlapCountsTx
orig.ev <- ev_function_1(RS1, RS2,...)
rand.ev <- lapply(RSL, function(x) {
return(ev_function_2(RS2, x,...))
})
rand.ev <- unlist(rand.ev)
ntimes <- length(rand.ev)
orig.ev <- ev_function_1(RS1, RS2)
rand.ev <- lapply(RSL, function(x) {
return(ev_function_2(RS2, x))
})
rand.ev <- unlist(rand.ev)
ntimes <- length(rand.ev)
zscore <- round((orig.ev - mean(rand.ev, na.rm = TRUE)) / sd(rand.ev,
na.rm = TRUE
), 4)
xcoords <- rand.ev
rand.mean <- mean(xcoords, na.rm = TRUE)
rand.sd <- sd(xcoords, na.rm = TRUE)
ntimes <- length(RSL)
pval <- (sum(orig.ev >= rand.ev, na.rm = TRUE) + 1) / (ntimes + 1)
pval
zscore <- round((orig.ev - mean(rand.ev, na.rm = TRUE)) / sd(rand.ev,
na.rm = TRUE
), 4)
xcoords <- rand.ev
rand.mean <- mean(xcoords, na.rm = TRUE)
rand.sd <- sd(xcoords, na.rm = TRUE)
ntimes <- length(RSL)
pval <- (sum(orig.ev <= rand.ev, na.rm = TRUE) + 1) / (ntimes + 1)
pval
pnorm(orig.ev, mean(rand.ev), sd(rand.ev),lower.tail= FALSE)
pnorm(orig.ev, mean(rand.ev), sd(rand.ev),lower.tail= TRUE)
p2
orig.ev1 <- readRDS("D:/RgnTX/RgnTX2022v.2/boxplot2/data500_500/orig.ev1.rds")
orig.ev2 <- readRDS("D:/RgnTX/RgnTX2022v.2/boxplot2/data500_500/orig.ev2.rds")
orig.ev3 <- readRDS("D:/RgnTX/RgnTX2022v.2/boxplot2/data500_500/orig.ev3.rds")
orig.ev4 <- readRDS("D:/RgnTX/RgnTX2022v.2/boxplot2/data500_500/orig.ev4.rds")
random.ev1 <- readRDS("D:/RgnTX/RgnTX2022v.2/boxplot2/data500_500/random.ev1.rds")
random.ev2 <- readRDS("D:/RgnTX/RgnTX2022v.2/boxplot2/data500_500/random.ev2.rds")
random.ev4 <- readRDS("D:/RgnTX/RgnTX2022v.2/boxplot2/data500_500/random.ev4.rds")
random.ev4 <- readRDS("D:/RgnTX/RgnTX2022v.2/boxplot2/data500_500/random.ev4.rds")
random.ev <- random.ev2
orig.ev <- orig.ev2
data <- data.frame(x = random.ev[order(random.ev)])
p1 <- ggplot(data, aes(x)) +
geom_histogram(aes(y = ..density..), alpha = 0.4) +
geom_point(data = data.frame(x = orig.ev, y = 0.01), aes(x=x, y=y),
color = 'red')
p1
random.ev <- random.ev1
orig.ev <- orig.ev1
data <- data.frame(x = random.ev[order(random.ev)])
p1 <- ggplot(data, aes(x)) +
geom_histogram(aes(y = ..density..), alpha = 0.4) +
geom_point(data = data.frame(x = orig.ev, y = 0.01), aes(x=x, y=y),
color = 'red')
p1
random.ev1
random.ev <- random.ev3
orig.ev <- orig.ev3
data <- data.frame(x = random.ev[order(random.ev)])
p1 <- ggplot(data, aes(x)) +
geom_histogram(aes(y = ..density..), alpha = 0.4) +
geom_point(data = data.frame(x = orig.ev, y = 0.01), aes(x=x, y=y),
color = 'red')
p1
random.ev <- random.ev4
orig.ev <- orig.ev4
data <- data.frame(x = random.ev[order(random.ev)])
p1 <- ggplot(data, aes(x)) +
geom_histogram(aes(y = ..density..), alpha = 0.4) +
geom_point(data = data.frame(x = orig.ev, y = 0.01), aes(x=x, y=y),
color = 'red')
p1
library(devtools)
load_all()
set.seed(12345677)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
file <- system.file(package="RgnTX", "extdata/m6A_sites_data.rds")
m6A_sites_data <- readRDS(file)
RS1 <- m6A_sites_data[1:500]
permTestTx_results <- permTestTxIA_customPick(RS1 = RS1,
txdb = txdb,
customPick_function = getStopCodon,
ntimes = 50,
ev_function_1 = overlapCountsTxIA,
ev_function_2 = overlapCountsTx)
p_a <- plotPermResults(permTestTx_results, binwidth = 1)
p_a
library(eoffice)
topptx(p_a,'R.pptx')
set.seed(12345677)
permTestTx_results <- permTestTxIA_customPick(RS1 = m6A_sites_data,
txdb = txdb,
customPick_function = getStopCodon,
ntimes = 50)
p_b <- plotPermResults(permTestTx_results, binwidth = 10)
p_b
topptx(p_b,'R.pptx')
set.seed(12345677)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
trans.ids1<- c("170")
RS1 <- randomizeTx(txdb = txdb, trans_ids = trans.ids1,
random_num = 20, random_length = 100)
RS2 <- randomizeTx(txdb = txdb, trans_ids = trans.ids1,
random_num = 20, random_length = 100)
trans.ids2 <-  c("170", "782", "974", "1364", "1387")
RSL <- randomizeTx(txdb = txdb, trans_ids = trans.ids2,
random_num = 20, random_length = 100, N = 50)
permTestTx_results <- permTestTx_customAll(RSL = RSL, RS1 = RS1, RS2 = RS2)
p1 = plotPermResults(permTestTx_results, binwidth = 1)
p1
plotPermResults(permTestTx_results)
p1 <- plotPermResults(permTestTx_results)
[1]
p1
topptx(p1,'R.pptx')
set.seed(12345677)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
exons.tx0 <- exonsBy(txdb)
trans.ids <- sample(names(exons.tx0), 50)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 50,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_a <- plotPermResults(permTestTx_results, binwidth = 1)
p_a
p_b <- plotPermResults(permTestTx_results, test_type = 'two-sided')
p_b
topptx(p1,'R.pptx')
topptx(p1,'R.pptx')
topptx(p_b,'R.pptx')
saveRDS(permTestTx_results,'R:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results5.1.rds')
saveRDS(permTestTx_results,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results5.1.rds')
p_c <- plotPermResults(permTestTx_results, alpha = 0.025)
p_c
p_d <- plotPermResults(permTestTx_results, alpha = 0.1)
p_d
topptx(p_b,'R.pptx')
topptx(p_c,'R.pptx')
topptx(p_d,'R.pptx')
set.seed(12345677)
permTestTx_results_e <- permTestTx( RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 50,
ev_function_1 = overlapWidthTx,
ev_function_2 = overlapWidthTx)
p_e <- plotPermResults(permTestTx_results_e)
p_e
topptx(p_e,'R.pptx')
permTestTx_results_f <- permTestTx( RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 50,
ev_function_1 = distanceTx,
ev_function_2 = distanceTx)
p_f <- plotPermResults(permTestTx_results_f)
p_f
set.seed(12345677)
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 500,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_g <- plotPermResults(permTestTx_results, binwidth = 1)
p_g
saveRDS(permTestTx_results,'R:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.7.rds')
saveRDS(permTestTx_results,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.7.rds')
set.seed(12345677)
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 1000,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_h <- plotPermResults(permTestTx_results, binwidth = 1)
p_h
p_g
set.seed(12345677)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 500,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_g <- plotPermResults(permTestTx_results, binwidth = 1)
p_g
saveRDS(permTestTx_results,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.7.rds')
set.seed(12345677)
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 500,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_g <- plotPermResults(permTestTx_results, binwidth = 1)
p_g
set.seed(12345677)
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 10,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_g <- plotPermResults(permTestTx_results, binwidth = 1)
p_g
set.seed(12345677)
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 10,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_g <- plotPermResults(permTestTx_results, binwidth = 1)
p_g
set.seed(12345677)
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 500,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_g <- plotPermResults(permTestTx_results, binwidth = 1)
p_g
saveRDS(permTestTx_results,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.7.rds')
set.seed(12345677)
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 1000,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_h <- plotPermResults(permTestTx_results, binwidth = 1)
p_h
saveRDS(permTestTx_results,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.8.rds')
load_all()
load_all()
permTestTx_results5.1 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results5.1.rds")
p1 = plotPermResults(permTestTx_results5.1, binwidth = 1)
p1
topptx(p1,'R.pptx')
set.seed(12345677)
permTestTx_results_e <- permTestTx( RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 50,
ev_function_1 = overlapWidthTx,
ev_function_2 = overlapWidthTx)
p_e <- plotPermResults(permTestTx_results_e)
p_e
set.seed(12345677)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
exons.tx0 <- exonsBy(txdb)
trans.ids <- sample(names(exons.tx0), 50)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
set.seed(12345677)
permTestTx_results_e <- permTestTx( RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 50,
ev_function_1 = overlapWidthTx,
ev_function_2 = overlapWidthTx)
p_e <- plotPermResults(permTestTx_results_e)
p_e
set.seed(12345677)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
permTestTx_results_e <- permTestTx( RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 50,
ev_function_1 = overlapWidthTx,
ev_function_2 = overlapWidthTx)
p_e <- plotPermResults(permTestTx_results_e)
p_e
saveRDS(permTestTx_results,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.5.rds')
set.seed(12345677)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
permTestTx_results_f <- permTestTx( RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 50,
ev_function_1 = distanceTx,
ev_function_2 = distanceTx)
p_f <- plotPermResults(permTestTx_results_f)
p_f
saveRDS(permTestTx_results,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.6.rds')
set.seed(12345677)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 500,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_g <- plotPermResults(permTestTx_results, binwidth = 1)
p_g
saveRDS(permTestTx_results,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.7.rds')
set.seed(12345677)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 1000,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_h <- plotPermResults(permTestTx_results, binwidth = 1)
p_h
set.seed(12345677)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
permTestTx_results <- permTestTx(RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 2000,
ev_function_1 = overlapCountsTx,
ev_function_2 = overlapCountsTx)
p_h <- plotPermResults(permTestTx_results, binwidth = 1)
p_h
saveRDS(permTestTx_results,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.8.rds')
p_h <- plotPermResults(permTestTx_results)
p_h
permTestTx_results5.1 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results5.1.rds")
p1 <- plotPermResults(permTestTx_results, binwidth = 1)
p_gp1
p1
p1 <- plotPermResults(permTestTx_results5.1, binwidth = 1)
p1
topptx(p1, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section5.1.pptx')
load_all()
topptx(p1, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section5.1.pptx')
p1 <- plotPermResults(permTestTx_results5.1, binwidth = 1)
p1
topptx(p1, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section5.1.pptx')
p1 <- plotPermResults(permTestTx_results5.1,test_type = 'two-sided')
p1
topptx(p1, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section7.2.pptx')
p_c <- plotPermResults(permTestTx_results, alpha = 0.025)
p_c
topptx(p_c, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section7.3.pptx')
p_c <- plotPermResults(permTestTx_results5.1, alpha = 0.025)
p_c
topptx(p_c, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section7.3.pptx')
p_c <- plotPermResults(permTestTx_results5.1, alpha = 0.1)
p_c
topptx(p_c, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section7.4.pptx')
permTestTx_results7.5 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.5.rds")
p_c <- plotPermResults(permTestTx_results7.5)
p_c
permTestTx_results7.6 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.6.rds")
p_c <- plotPermResults(permTestTx_results7.6)
p_c
permTestTx_results7.6 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.6.rds")
p_c <- plotPermResults(permTestTx_results7.6)
p_c
permTestTx_results7.8 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.8.rds")
p_c <- plotPermResults(permTestTx_results7.8)
p_c
permTestTx_results7.7 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.7.rds")
p_c <- plotPermResults(permTestTx_results7.7)
p_c
set.seed(12345677)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
permTestTx_results_e <- permTestTx( RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 50,
ev_function_1 = overlapWidthTx,
ev_function_2 = overlapWidthTx)
p_e <- plotPermResults(permTestTx_results_e)
p_e
saveRDS(permTestTx_results_e,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.5.rds')
permTestTx_results7.5 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.5.rds")
p_c <- plotPermResults(permTestTx_results7.5)
p_c
topptx(p_c, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section7.5.pptx')
set.seed(12345677)
A <- randomizeTx(txdb, trans.ids, random_num = 100, random_length = 100)
B <- c(randomizeTx(txdb, trans.ids, random_num = 75, random_length = 100),
A[1:25])
permTestTx_results_f <- permTestTx( RS1 = A,
RS2 = B,
txdb = txdb,
type = "mature",
ntimes = 50,
ev_function_1 = distanceTx,
ev_function_2 = distanceTx)
p_f <- plotPermResults(permTestTx_results_f)
p_f
saveRDS(permTestTx_results_f,'D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.6.rds')
p_c <- plotPermResults(permTestTx_results7.5)
p_c
permTestTx_results7.6 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.6.rds")
p_c <- plotPermResults(permTestTx_results7.6)
p_c
topptx(p_c, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section7.6.pptx')
permTestTx_results7.7 <- readRDS("D:/RgnTX/RgnTX2022v.2/vignette/permTestTx_results7.7.rds")
p_c <- plotPermResults(permTestTx_results7.7)
p_c
topptx(p_c, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section7.7.pptx')
p_c <- plotPermResults(permTestTx_results7.8)
p_c
topptx(p_c, 'D:/RgnTX/RgnTX2022v.2/vignette/R_section7.8.pptx')
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
trans.ids <- c("170", "782", "974", "1364", "1387")
exons.tx0 <- exonsBy(txdb)
regions.A <- exons.tx0[trans.ids]
A <- randomizeTransByOrder(regions.A, random_length = 20)
B <- randomizeTransByOrder(regions.A, random_length = 20)
overlapCountsTx(A, B)
overlapCountsTx
install()
library(devtools)
install()
library(RgnTX)
knitr::include_graphics("figures/section8.png")
check()
check()
check()
check(vignettes = F)
BiocCheck()
library(BiocCheck)
BiocCheck()
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.2/package/RgnTX', nlines=Inf)
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.2/package/RgnTX', nlines=Inf)
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.2/package/RgnTX', nlines=Inf)
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.2/RgnTX', nlines=Inf)
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.2/RgnTX', nlines=Inf)
load_all()
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.2/RgnTX', nlines=Inf)
styler::style_pkg(transformers = styler::tidyverse_style(indent_by = 4))
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.1/package/RgnTX', nlines=Inf)
load_all()
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.1/package/RgnTX', nlines=Inf)
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.1/package/RgnTX', nlines=Inf)
load_all()
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.1/package/RgnTX', nlines=Inf)
load_all()
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.1/package/RgnTX', nlines=Inf)
load_all()
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.1/package/RgnTX', nlines=Inf)
load_all()
BiocCheck:::checkFormatting('D:/RgnTX/RgnTX2022v.1/package/RgnTX', nlines=Inf)
load_all()
install()
